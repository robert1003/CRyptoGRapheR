\begin{itemize}[leftmargin=*]
\setlength\itemsep{0.2em}
\item Lucas’ Theorem :\\
  For $n, m \in \mathbb{Z}^{*}$ and prime $P$,
  $C(m,n) \mod P$
  %= C(\frac{m}{M},n/M) * C(m\%M,n\%M) mod P
	$= \Pi ( C(m_i,n_i) )$
	where $m_i$ is the $i$-th digit of $m$ in base $P$.
\item 1st Stirling Numbers(permutation $|P|=n$ with $k$ cycles): \\
  $S(n,k) = \text{coefficient of }x^k \text{ in } \Pi_{i=0}^{n-1} (x+i)$ \\
  $S(n+1,k) = nS(n,k)+S(n,k-1)$
\item 2nd Stirling Numbers(Partition $n$ elements into $k$ non-empty set): \\
  $S(n,k) = \frac{1}{k!} \sum\limits_{j=0}^k (-1)^{k-j} {k \choose j} j^n$ \\
  $S(n+1,k) = kS(n,k)+S(n,k-1)$
\item Calculate $f(x+n)$ where $f(x)=\sum\limits_{i=0}^{n-1}a_ix^i$: \\
  $f(x+n)=\sum\limits_{i=0}^{n-1}a_i(x+n)^i=\sum\limits_{i=0}^{n-1}x^i\cdot\frac{1}{i!}\sum\limits_{j=i}^{n-1}\frac{a_j}{j!}\cdot\frac{n^{j-i}}{(j-i)!}$
\item Calculate $c[i-j]+=a[i]\times b[j]$ for $a[n],b[m]$ \\
  1. a=reverse(a); c=mul(a,b); c=reverse(c[:n]); \\
  2. b=reverse(b); c=mul(a,b); c=rshift(c,m-1); 
\item Eulerian number(permutation $1\sim n$ with $m$ $a[i]>a[i-1]$): \\
  $A(n,m)=\sum\limits_{i=0}^{m}(-1)^i {n+1\choose i} (m+1-i)^n $ \\
  $A(n,m)=(n-m)A(n-1,m-1)+(m+1)A(n-1,m)$
\item Derangement: \\
  $D(n)=(n-1)(D(n-1)+D(n-2))=nD(n-1)+(-1)^n$
\item Pick’s Theorem : $A = i + b/2 - 1$
\item Euler Characteristic: \\
  planar graph: $V-E+F-C=1$ \\
  convex polyhedron: $V-E+F=2$ \\
  $V,E,F,C$: number of vertices, edges, faces(regions), and components
\item Kirchhoff's theorem :\\
  -- number of spanning tree of undirected graph:\\
  degree matrix $D_{ii} = deg(i)$ , $D_{ij} = 0$\\
  adjacency matrix $G_{ij} = \#\;of\;(i,j) \in E$ , $G_{ii} = 0$,\\
  let $A = D - G$, delete any one row, one column, and cal $det(A')$\\
  -- number of spanning tree of directed graph:\\
  in-degree matrix $D_{ii}^{in} = indeg(i)$ , $D_{ij}^{in} = 0$\\
  out-degree matrix $D_{ii}^{out} = outdeg(i)$ , $D_{ij}^{out} = 0$\\
  let $L^{in} = D^{in} - G$ , $L^{out} = D^{out} - G$ , delete the $i$-th row and column\\
  $det(L_i^{in})$ and $det(L_i^{out})$ is the number of spanning tree from/to root $i$\\
\item Burnside Lemma:
  $|X/G|=\frac{1}{|G|}\sum\limits_{g \in G} {|X^g|}$
\item Polya theorem:
  $|Y^x/G|=\frac{1}{|G|}\sum\limits_{g \in G} {m^{c(g)}}$\\
  $m = |Y|$ : num of colors, c(g) : num of cycle
\item Anti SG (the person who has no strategy wins) :\\
  first player wins iff either\\
  1. SG value of ALL subgame $\le$ $1$ and SG value of the game $=$ $0$\\
  2. SG value of some subgame $>$ $1$ and SG value of the game $\neq$ $0$
\item Möbius inversion formula :\\
  $g(n) = \sum\limits_{d|n}f(d)$ for every integer $n\ge 1$ , then\\
  $f(n) = \sum\limits_{d|n}\mu(d)g(\frac{n}{d}) = \sum\limits_{d|n}\mu(\frac{n}{d})g(d)$ for every integer $n\ge 1$\\
  %$\sum\limits_{d|n}\mu(d)=\epsilon(n)=[n=1]$ , 
  %$\sum\limits_{d|n}\phi(d)=n\Leftrightarrow \phi(n)=\sum\limits_{d|n}\mu(d)(\frac{n}{d})$\\
  Dirichlet convolution : $f*g=g*f=\sum\limits_{d|n}f(d)g(\frac{n}{d})=\sum\limits_{d|n}f(\frac{n}{d})g(d)$\\
  $g=f*1\Leftrightarrow f=g*\mu$, $\epsilon=\mu*1$, $Id=\phi*1$, $d=1*1$, $\sigma=Id*1=\phi*d$,\\
  $\sigma_k=Id_k*1$ where $\epsilon(n)=[n=1]$, $1(n)=1$, $Id(n)=n$, $Id_k(n)=n^k$,\\
  $d(n)=\#(divisor)$, $\sigma(n)=\sum divisor$, $\sigma_k(n)=\sum divisor^k$
\item Find a Primitive Root of $n$:\\
  $n$ has primitive roots iff $n=2,4,p^k,2p^k$ where $p$ is an odd prime.\\
  1. Find $\phi(n)$ and all prime factors of $\phi(n)$, says $P=\{p_1,...,p_m\}$\\
  2. $\forall g\in[2,n)$, if $g^{\frac{\phi(n)}{p_i}}\ne 1,\forall p_i\in P$, then $g$ is a primitive root.\\
  3. Since the smallest one isn't too big, the algorithm runs fast.\\
  4. $n$ has exactly $\phi(\phi(n))$ primitive roots.
\item Sum of Two Squares Thm (Legendre):\\
  For a given positive integer $N$, let\\
  $D1 = (\#$ of $d \in N$ dividing $N$ that $d=1$ (mod 4))\\
  $D3 = (\#$ of $d \in N$ dividing $N$ that $d=3$ (mod 4))\\
  then $N$ can be written as a sum of two squares in\\
  exactly $R(N) = 4(D1-D3)$ ways.
\item Difference of $D1-D3$ Thm:\\
  let $N=2^t \times [p_1^{e_1} \times ...\times p_r^{e_r}] \times [q_1^{f_1} \times ...\times q_s^{f_s}]$\\
  where $p_i \in mod\;4 = 1\;prime$ , $q_i \in mod\;4 = 3\;prime$\\
  then $D1 - D3 = \begin{cases}(e1+1)(e2+1)...(er+1)\;\;\;if\;f_i\;all\;even\\0\;\;\;if\;any\;f_i\;is\;odd\end{cases}$
\item Sherman-Morrison formula:\\
  suppose $A \in \mathbb{R}^{n\times n}$ is invertible and $u,v \in \mathbb{R}^n$\\
  $A + uv^T$ is invertible if and only if $1 + v^TA^{-1}u \ne 0$\\
  $(A + uv^T)^{-1} = A^{-1} - \frac{A^{-1}uv^TA^{-1}}{1+v^TA^{-1}u}$\\
\item Pohlig-Hellman algorithm (discrete log):\\
  Given an order $n$ group, generator $g$, element $h$, find $x$ s.t. $g^x=h$.\\
  If $n=p^e$:\\
    * let $x_0=0$, $\gamma=g^{p^{e-1}}$ where $\gamma$ has order $p$.\\
    * for $k=0\sim e-1$:\\
    1. let $h_k=(g^{-x_k}h)^{p^{e-1-k}}$ whose order divide $p\implies h_k\in \langle\gamma\rangle$.\\
    2. find $d_k$ s.t. $\gamma^{d_k}=h_k$ with baby-step giant-step in $O(\sqrt p)$.\\
    3. set $x_{k+1}=x_k+p^kd_k$\\
    * return $x_e$ in total time complexity $O(e\sqrt p)$\\
  If $n=\Pi_{i=1}^{r}p_i^{e_i}$:\\
    * for each $i=1\sim r$:\\
    1. let $g_i=g^{n/p_i^{e_i}}$ having order $p_i^{e_i}$, $h_i=h^{n/p_i^{e_i}}$ where $h_i\in\langle g_i\rangle$.\\
    2. find $x_i$ s.t. $g_i^{x_i}=h_i$ using above algorithm.\\
    * return $x=CRT(\{x_i\mod p_i^{e_i}\})$
\end{itemize}
